// *********************************************************************
// Generated by JagStudio
// Based on BCX32 - BASIC To C/C++ Translator (V) 6.00 (2009/06/02)
//                 BCX (c) 1999 - 2009 by Kevin Diggins
//              Translated for compiling with a C Compiler
// *********************************************************************
// *********************************************************************

// ***************************************************
// Compiler Defines
// ***************************************************

// C++
#if defined( __cplusplus )
  #define overloaded
  #define C_EXPORT EXTERN_C __declspec(dllexport)
  #define C_IMPORT EXTERN_C __declspec(dllimport)
#else
  #define C_EXPORT __declspec(dllexport)
  #define C_IMPORT __declspec(dllimport)
#endif

#include "jstudio.h"
#include "romassets.h"
#define UINT unsigned int
#define WORD short
#define BYTE char
#define UWORD unsigned short
#define UBYTE unsigned char
//Lines inserted deliberately because of some bcx brokeness - fix at some point!
//Lines inserted deliberately because of some bcx brokeness - fix at some point!
//Lines inserted deliberately because of some bcx brokeness - fix at some point!
#define peek(x) (*(volatile char *)(x))
#define dpeek(x) (*(volatile short *)(x))
#define lpeek(x) (*(volatile int *)(x))
// *************************************************
//               Standard Macros
// *************************************************
#define STRPTR(A)((char*)&(A))
void    midstr (char*, int, int, char *);
// *************************************************
//            User Global Initialized Arrays
// *************************************************

// *************************************************
//            User Global Variables
// *************************************************

static short   i;
static short   j;
static char    name[2048];
static int     srcname;
static int     dstname;
static int     eeprom_present=0;


// *************************************************
//                  Main Program
// *************************************************

void basicmain()
{
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 9] dim i as short
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 10] dim j as short
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 11] dim name$
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 12] dim srcname%,dstname%
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 13] jsfSetFontSize(0)
jsfSetFontSize(0);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 14] dim eeprom_present%=0
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 18] jsfSetFontIndx(1)
jsfSetFontIndx(1);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 20] CALL rapMTInit
rapMTInit();
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 24] if rapMTPresent<0 then
if(rapMTPresent<0)
  {
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 29] eeprom_present=jsfEEPROM(1,rapHighscoresScore)
    eeprom_present=jsfEEPROM(1,rapHighscoresScore);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 30] if eeprom_present=1 then
    if(eeprom_present==1)
      {
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 32] for i=0 to 9
        for(i=0; i<=9; i+=1)
          {
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 33] rapHighscoresScore[i]=(9-i)*100
            rapHighscoresScore[i]=(9-i)*100;
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 34] next i
          }
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 36] jsfEEPROM(0,rapHighscoresScore)
        jsfEEPROM(0,rapHighscoresScore);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 38] eeprom_present=jsfEEPROM(1,rapHighscoresScore)
        eeprom_present=jsfEEPROM(1,rapHighscoresScore);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 39] endif
      }
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 41] if eeprom_present<>0 then
    if(eeprom_present!=0)
      {
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 45] rapLocate 160,0
        rapLocate(160,0);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 46] rapPrint "No MT/EE detected!"
        js_r_textbuffer=(char *)"No MT/EE detected!";
        rapPrint();
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 47] for i=0 to 9
        for(i=0; i<=9; i+=1)
          {
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 48] rapHighscoresScore[i]=(9-i)*100
            rapHighscoresScore[i]=(9-i)*100;
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 49] next i
          }
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 50] else
      }
    else
      {
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 54] rapLocate 160,0
        rapLocate(160,0);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 55] rapPrint "EEPROM detected!"
        js_r_textbuffer=(char *)"EEPROM detected!";
        rapPrint();
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 57] rapLocate 0,25*8
        rapLocate(0,25*8);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 58] jsfSetFontIndx(1)
        jsfSetFontIndx(1);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 60] endif
      }
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 61] else
  }
else
  {
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 62] rapLocate 160,0
    rapLocate(160,0);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 63] rapPrint "MT detected!"
    js_r_textbuffer=(char *)"MT detected!";
    rapPrint();
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 68] rapLocate 0,25*8
    rapLocate(0,25*8);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 69] jsfSetFontIndx(1)
    jsfSetFontIndx(1);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 70] print "Saved value:",rapHighscoresScore[31]
    js_r_textbuffer=ee_printf("%s% d","Saved value:",(int)rapHighscoresScore[31]);
    rapPrint();
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 75] rapHighscoresScore[31]=123456789
    rapHighscoresScore[31]=123456789;
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 77] endif
  }
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 81] rapLocate 0,0
rapLocate(0,0);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 82] rapPrint "Initial table:"
js_r_textbuffer=(char *)"Initial table:";
rapPrint();
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 83] jsfSetFontIndx(0)
jsfSetFontIndx(0);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 85] dstname=(int)strptr(name$)
dstname=(int)STRPTR(name);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 86] mid$(name$,9,1)=""
midstr(name,9,1,"");
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 88] for i=0 to 9
for(i=0; i<=9; i+=1)
  {
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 89] rapLocate 0,8+i*8
    rapLocate(0,8+i*8);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 91] srcname=(int)strptr(rapHighscoresName[9-i]);
    srcname=(int)STRPTR(rapHighscoresName[9-i]);;
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 92] lpoke dstname,lpeek(srcname)
    *(volatile unsigned int*)(dstname)=(volatile unsigned int)    lpeek(srcname);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 93] lpoke dstname+4,lpeek(srcname+4)
    *(volatile unsigned int*)(dstname+4)=(volatile unsigned int)    lpeek(srcname+4);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 94] PRINT "#";i;" - ";name$;" -";rapHighscoresScore[9-i]
    js_r_textbuffer=ee_printf("%s% d%s%s%s% d","#",(int)i," - ",name," -",(int)rapHighscoresScore[9-i]);
    rapPrint();
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 95] next i
  }
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 100] jsfSetFontIndx(1)
jsfSetFontIndx(1);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 101] rapLocate 0,8*10+8+8
rapLocate(0,8*10+8+8);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 102] rapPrint "After a highscore of 432 points:"
js_r_textbuffer=(char *)"After a highscore of 432 points:";
rapPrint();
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 103] jsfSetFontIndx(0)
jsfSetFontIndx(0);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 104] name$="I WON!!!"
strcpy(name,"I WON!!!");
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 105] if rapHiscoreCheck(432,name$,0)>0 then
if(rapHiscoreCheck(432,name,0)>0)
  {
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 106] call rapHiscoreSort(0)
    rapHiscoreSort(0);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 107] endif
  }
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 108] for i=0 to 9
for(i=0; i<=9; i+=1)
  {
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 109] rapLocate 0,8*10+8+8+8+i*8
    rapLocate(0,8*10+8+8+8+i*8);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 111] srcname=(int)strptr(rapHighscoresName[9-i]);
    srcname=(int)STRPTR(rapHighscoresName[9-i]);;
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 112] lpoke dstname,lpeek(srcname)
    *(volatile unsigned int*)(dstname)=(volatile unsigned int)    lpeek(srcname);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 113] lpoke dstname+4,lpeek(srcname+4)
    *(volatile unsigned int*)(dstname+4)=(volatile unsigned int)    lpeek(srcname+4);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 114] PRINT "#";i;" - ";name$;" -";rapHighscoresScore[9-i]
    js_r_textbuffer=ee_printf("%s% d%s%s%s% d","#",(int)i," - ",name," -",(int)rapHighscoresScore[9-i]);
    rapPrint();
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 115] next i
  }
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 119] jsfSetFontIndx(1)
jsfSetFontIndx(1);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 120] rapLocate 0,8*10+8+8+8+10*8+8
rapLocate(0,8*10+8+8+8+10*8+8);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 122] if rapMTPresent<0 then
if(rapMTPresent<0)
  {
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 123] if eeprom_present<>0 then
    if(eeprom_present!=0)
      {
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 124] rapPrint "No MT/EE detected, so no scores saved!"
        js_r_textbuffer=(char *)"No MT/EE detected, so no scores saved!";
        rapPrint();
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 125] else
      }
    else
      {
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 126] eeprom_present=jsfEEPROM(0,rapHighscoresScore)
        eeprom_present=jsfEEPROM(0,rapHighscoresScore);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 127] if eeprom_present=0 then
        if(eeprom_present==0)
          {
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 128] rapPrint "EEPROM detected, scores saved!"
            js_r_textbuffer=(char *)"EEPROM detected, scores saved!";
            rapPrint();
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 129] else
          }
        else
          {
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 130] rapPrint "EEPROM detected, save fail!"
            js_r_textbuffer=(char *)"EEPROM detected, save fail!";
            rapPrint();
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 131] endif
          }
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 132] endif
      }
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 133] else
  }
else
  {
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 134] call rapMTSave
    rapMTSave();
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 135] rapPrint "Memory Track detected, scores saved!"
    js_r_textbuffer=(char *)"Memory Track detected, scores saved!";
    rapPrint();
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 136] endif
  }
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 138] do
for(;;)
  {
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 140] vsync
    jsfVsync(0);
// [/home/tbone/Programming/jagstudio/projects/basic/scores/scores.bas - 141] loop
  }
  while(1) {};   //  End of main program
}

// *************************************************
//                 Runtime Functions
// *************************************************

void midstr (char *src, int st, int length, char *rep)
{
  int srclen = strlen(src);
  if(st>srclen++ || st<1) return;
  int replen = strlen(rep);
  if(replen < length || length==-1) length=replen;
  if((st+length) > srclen) length=srclen-st;
  memcpy(&src[st-1],rep,length);
}


