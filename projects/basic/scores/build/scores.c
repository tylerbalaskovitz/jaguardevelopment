// *********************************************************************
// Generated by JagStudio
// Based on BCX32 - BASIC To C/C++ Translator (V) 6.00 (2009/06/02)
//                 BCX (c) 1999 - 2009 by Kevin Diggins
//              Translated for compiling with a C Compiler
// *********************************************************************
// *********************************************************************

// ***************************************************
// Compiler Defines
// ***************************************************

// C++
#if defined( __cplusplus )
  #define overloaded
  #define C_EXPORT EXTERN_C __declspec(dllexport)
  #define C_IMPORT EXTERN_C __declspec(dllimport)
#else
  #define C_EXPORT __declspec(dllexport)
  #define C_IMPORT __declspec(dllimport)
#endif

#include "jstudio.h"
#include "romassets.h"
#define UINT unsigned int
#define WORD short
#define BYTE char
#define UWORD unsigned short
#define UBYTE unsigned char
//Lines inserted deliberately because of some bcx brokeness - fix at some point!
//Lines inserted deliberately because of some bcx brokeness - fix at some point!
//Lines inserted deliberately because of some bcx brokeness - fix at some point!
#define peek(x) (*(volatile char *)(x))
#define dpeek(x) (*(volatile short *)(x))
#define lpeek(x) (*(volatile int *)(x))
// *************************************************
//               Standard Macros
// *************************************************
#define STRPTR(A)((char*)&(A))
void    midstr (char*, int, int, char *);
// *************************************************
//            User Global Initialized Arrays
// *************************************************

// *************************************************
//            User Global Variables
// *************************************************

static short   i;
static short   j;
static char    name[2048];
static int     srcname;
static int     dstname;
static int     eeprom_present=0;


// *************************************************
//                  Main Program
// *************************************************

void basicmain()
{
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 8] dim i as short
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 9] dim j as short
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 10] dim name$
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 11] dim srcname%,dstname%
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 12] jsfSetFontSize(0)
jsfSetFontSize(0);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 13] dim eeprom_present%=0
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 17] jsfSetFontIndx(1)
jsfSetFontIndx(1);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 19] CALL rapMTInit
rapMTInit();
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 23] if rapMTPresent<0 then
if(rapMTPresent<0)
  {
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 28] eeprom_present=jsfEEPROM(1,rapHighscoresScore)
    eeprom_present=jsfEEPROM(1,rapHighscoresScore);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 29] if eeprom_present=1 then
    if(eeprom_present==1)
      {
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 31] for i=0 to 9
        for(i=0; i<=9; i+=1)
          {
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 32] rapHighscoresScore[i]=(9-i)*100
            rapHighscoresScore[i]=(9-i)*100;
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 33] next i
          }
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 35] jsfEEPROM(0,rapHighscoresScore)
        jsfEEPROM(0,rapHighscoresScore);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 37] eeprom_present=jsfEEPROM(1,rapHighscoresScore)
        eeprom_present=jsfEEPROM(1,rapHighscoresScore);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 38] endif
      }
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 40] if eeprom_present<>0 then
    if(eeprom_present!=0)
      {
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 44] rapLocate 160,0
        rapLocate(160,0);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 45] rapPrint "No MT/EE detected!"
        js_r_textbuffer=(char *)"No MT/EE detected!";
        rapPrint();
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 46] for i=0 to 9
        for(i=0; i<=9; i+=1)
          {
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 47] rapHighscoresScore[i]=(9-i)*100
            rapHighscoresScore[i]=(9-i)*100;
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 48] next i
          }
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 49] else
      }
    else
      {
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 53] rapLocate 160,0
        rapLocate(160,0);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 54] rapPrint "EEPROM detected!"
        js_r_textbuffer=(char *)"EEPROM detected!";
        rapPrint();
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 56] rapLocate 0,25*8
        rapLocate(0,25*8);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 57] jsfSetFontIndx(1)
        jsfSetFontIndx(1);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 59] endif
      }
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 60] else
  }
else
  {
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 61] rapLocate 160,0
    rapLocate(160,0);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 62] rapPrint "MT detected!"
    js_r_textbuffer=(char *)"MT detected!";
    rapPrint();
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 67] rapLocate 0,25*8
    rapLocate(0,25*8);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 68] jsfSetFontIndx(1)
    jsfSetFontIndx(1);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 69] print "Saved value:",rapHighscoresScore[31]
    js_r_textbuffer=ee_printf("%s% d","Saved value:",(int)rapHighscoresScore[31]);
    rapPrint();
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 74] rapHighscoresScore[31]=123456789
    rapHighscoresScore[31]=123456789;
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 76] endif
  }
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 80] rapLocate 0,0
rapLocate(0,0);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 81] rapPrint "Initial table:"
js_r_textbuffer=(char *)"Initial table:";
rapPrint();
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 82] jsfSetFontIndx(0)
jsfSetFontIndx(0);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 84] dstname=(int)strptr(name$)
dstname=(int)STRPTR(name);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 85] mid$(name$,9,1)=""
midstr(name,9,1,"");
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 87] for i=0 to 9
for(i=0; i<=9; i+=1)
  {
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 88] rapLocate 0,8+i*8
    rapLocate(0,8+i*8);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 90] srcname=(int)strptr(rapHighscoresName[9-i]);
    srcname=(int)STRPTR(rapHighscoresName[9-i]);;
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 91] lpoke dstname,lpeek(srcname)
    *(volatile unsigned int*)(dstname)=(volatile unsigned int)    lpeek(srcname);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 92] lpoke dstname+4,lpeek(srcname+4)
    *(volatile unsigned int*)(dstname+4)=(volatile unsigned int)    lpeek(srcname+4);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 93] PRINT "#";i;" - ";name$;" -";rapHighscoresScore[9-i]
    js_r_textbuffer=ee_printf("%s% d%s%s%s% d","#",(int)i," - ",name," -",(int)rapHighscoresScore[9-i]);
    rapPrint();
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 94] next i
  }
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 99] jsfSetFontIndx(1)
jsfSetFontIndx(1);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 100] rapLocate 0,8*10+8+8
rapLocate(0,8*10+8+8);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 101] rapPrint "After a highscore of 432 points:"
js_r_textbuffer=(char *)"After a highscore of 432 points:";
rapPrint();
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 102] jsfSetFontIndx(0)
jsfSetFontIndx(0);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 103] name$="I WON!!!"
strcpy(name,"I WON!!!");
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 104] if rapHiscoreCheck(432,name$,0)>0 then
if(rapHiscoreCheck(432,name,0)>0)
  {
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 105] call rapHiscoreSort(0)
    rapHiscoreSort(0);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 106] endif
  }
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 107] for i=0 to 9
for(i=0; i<=9; i+=1)
  {
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 108] rapLocate 0,8*10+8+8+8+i*8
    rapLocate(0,8*10+8+8+8+i*8);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 110] srcname=(int)strptr(rapHighscoresName[9-i]);
    srcname=(int)STRPTR(rapHighscoresName[9-i]);;
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 111] lpoke dstname,lpeek(srcname)
    *(volatile unsigned int*)(dstname)=(volatile unsigned int)    lpeek(srcname);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 112] lpoke dstname+4,lpeek(srcname+4)
    *(volatile unsigned int*)(dstname+4)=(volatile unsigned int)    lpeek(srcname+4);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 113] PRINT "#";i;" - ";name$;" -";rapHighscoresScore[9-i]
    js_r_textbuffer=ee_printf("%s% d%s%s%s% d","#",(int)i," - ",name," -",(int)rapHighscoresScore[9-i]);
    rapPrint();
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 114] next i
  }
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 118] jsfSetFontIndx(1)
jsfSetFontIndx(1);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 119] rapLocate 0,8*10+8+8+8+10*8+8
rapLocate(0,8*10+8+8+8+10*8+8);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 121] if rapMTPresent<0 then
if(rapMTPresent<0)
  {
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 122] if eeprom_present<>0 then
    if(eeprom_present!=0)
      {
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 123] rapPrint "No MT/EE detected, so no scores saved!"
        js_r_textbuffer=(char *)"No MT/EE detected, so no scores saved!";
        rapPrint();
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 124] else
      }
    else
      {
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 125] eeprom_present=jsfEEPROM(0,rapHighscoresScore)
        eeprom_present=jsfEEPROM(0,rapHighscoresScore);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 126] if eeprom_present=0 then
        if(eeprom_present==0)
          {
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 127] rapPrint "EEPROM detected, scores saved!"
            js_r_textbuffer=(char *)"EEPROM detected, scores saved!";
            rapPrint();
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 128] else
          }
        else
          {
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 129] rapPrint "EEPROM detected, save fail!"
            js_r_textbuffer=(char *)"EEPROM detected, save fail!";
            rapPrint();
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 130] endif
          }
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 131] endif
      }
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 132] else
  }
else
  {
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 133] call rapMTSave
    rapMTSave();
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 134] rapPrint "Memory Track detected, scores saved!"
    js_r_textbuffer=(char *)"Memory Track detected, scores saved!";
    rapPrint();
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 135] endif
  }
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 137] do
for(;;)
  {
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 139] vsync
    jsfVsync(0);
// [F:\Jaguar\Tools\JagStudio\projects\basic\scores\scores.bas - 140] loop
  }
  while(1) {};   //  End of main program
}

// *************************************************
//                 Runtime Functions
// *************************************************

void midstr (char *src, int st, int length, char *rep)
{
  int srclen = strlen(src);
  if(st>srclen++ || st<1) return;
  int replen = strlen(rep);
  if(replen < length || length==-1) length=replen;
  if((st+length) > srclen) length=srclen-st;
  memcpy(&src[st-1],rep,length);
}


